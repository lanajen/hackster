$(function(){
  $('.file_upload.<%= file_type %>').fileupload({
    limitMultiFileUploads: 1,
    sequentialUploads: true,
    limitConcurrentUploads: 1,
    dropZone: '.file-drop.<%= file_type %>',
    add: function(e, data) {
      file = data.files[0];
      data = <%= file_type %>Functions.fileuploadAdd(data, file);
      var jqXHR = data.submit();
    },

    fail: function(e, data){
      target = <%= file_type %>Functions.fileuploadTargetForFail(data);
      console.log(data);
      target.replaceWith('Error, please retry. If the problem persists please email <a href="mailto:team@hackster.io?subject=My file won\'t upload&body=Debug info:%0D%0Atype: ' + data.files[0].type + '%0D%0Asize: ' + data.files[0].size + '%0D%0Abitrate: ' + data.bitrate + '">team@hackster.io</a>')
    },

    progress: function(e, data) {
      progress = parseInt(data.loaded / data.total * 100, 10);
      target = <%= file_type %>Functions.fileuploadTargetForProgress(data);
      target.css('width', progress + '%');
    },

    done: function(e, data){
      <%= file_type %>Functions.fileuploadDone(data);
    }
  });
});