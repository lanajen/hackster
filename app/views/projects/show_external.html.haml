= content_for :head do
  %meta(property="og:title" content="#{@project.name}")
  - if @project.one_liner.present?
    %meta(property="og:description" content="#{@project.one_liner} By #{@project.guest_or_user_name}.")
  %meta(property="og:image" content="#{@project.cover_image(:cover_thumb)}")
  %meta(property="og:url" content="#{external_project_url(@project)}")
  %meta(property="og:site_name" content="Hackster.io")
  %meta(property="twitter:card" content="summary")
  %meta(property="twitter:site" content="@hacksterio")
  %meta(property="twitter:domain" content="hackster.io")
  %meta(property="twitter:title" content="#{@project.name}")
  %meta(property="twitter:description" content="#{@project.one_liner}")
  - if user = @project.users.first and link = user.twitter_link.presence and handle = link.match(/twitter.com\/(.+)/).try(:[], 1)
    %meta(property="twitter:creator" content="@#{handle}")
  %meta(property="twitter:image:src" content="#{@project.cover_image(:cover_thumb)}")
  %link(rel="canonical" href="#{external_project_url(@project)}")
  - if @project.tech_tags_string.present?
    %meta(name='keywords' content="#{@project.tech_tags_string}")

= content_for :no_container do
  #heading.project
    .display
      .container
        .row.teaser
          .col-xs-12
            %h1
              - if @project.logo(:thumb, false)
                = image_tag @project.logo(:thumb), class: 'project-logo'
              - if @project.private?
                %small
                  %i.fa.fa-lock.istooltip{ title: 'Private project', data: { container: 'body' } }
              = link_to @project.name, external_project_path(@project), class: 'hidden-link'

        .row.teaser
          .col-xs-12
            .well
              - cache [@project, 'teaser'], tag: (["project-#{@project.id}-teaser"]) do
                .row
                  .col-xs-8{ style: 'padding-right: 0;'}
                    = image_tag @project.cover_image, alt: @project.name, class: 'cover-image'

                  .col-xs-4{ style: 'padding-left: 0;'}
                    .text-holder
                      .title
                        = @project.name
                        - if @project.wip?
                          %small
                            %i.fa.fa-bolt.istooltip{ title: 'Work in progress' }
                      - if @project.one_liner.present?
                        .one-liner= @project.one_liner

                      .one-liner
                        Read about this project on
                        = link_to URI.parse(@project.website).host.gsub(/^www\./, ''), @project.website, target: '_blank'

                      - if @project.guest_name.present? or member = @project.team.try(:active_members).try(:includes, :user).try(:first)
                        .team-widget.meta
                          .meta-title
                            Hacker
                          - if @project.guest_name.present?
                            .user.pull-left
                              = @project.guest_name
                            .pull-right
                              %small
                                Is this you?
                                - if user_signed_in?
                                  = link_to 'Claim this project', claim_project_path(@project), data: { method: :post }
                                - else
                                  = link_to 'Claim this project', new_user_registration_path(reason: 'claim', m: 'project', id: @project.id)
                            .clearfix
                          - elsif member
                            = render partial: 'users/line_thumb', locals: { member: member }

                      - if @project.tech_tags.any?
                        .tags.meta
                          .meta-title Technologies
                          - @project.tech_tags.pluck(:name).each do |tag|
                            - if tech = Tech.includes(:tech_tags).references(:tags).where("LOWER(tags.name) = ?", tag.downcase).first
                              - tag_link = tech_short_path(tech)
                            - else
                              - tag_link = "/tags/#{CGI::escape(tag)}"
                            %span= link_to tag, tag_link, class: 'hidden-link'

                      - if @project.product_tags.any?
                        .tags.meta
                          .meta-title Tags
                          - @project.product_tags.pluck(:name).each do |tag|
                            %span= link_to tag, "/tags/#{CGI::escape(tag)}", class: 'hidden-link'

                      .meta
                        %strong Created on
                        = l @project.created_at, format: :date
                        -# if @project.created_at.to_date != @project.made_public_at.to_date
                          %br
                          %strong Published on
                          = l @project.made_public_at, format: :date

                      -# if @project.guest_name.present?
                        .meta
                          %strong Posted by
                          - poster = @project.team.active_members.includes(:user).first.user
                          = link_to poster.name, poster

                      - if @project.license
                        .license.meta
                          &copy;
                          = link_to @project.license.abbr, @project.license.url, target: '_blank', class: 'hidden-link'

                      .actions
                        %p.meta.text-center
                          %strong= number_with_delimiter @project.impressions_count
                          = pluralize_without_count @project.impressions_count, 'view'
                          &nbsp;
                          %strong= number_with_delimiter @project.respects_count
                          = pluralize_without_count @project.respects_count, 'respect'
                        %ul.text-center.list-unstyled.list-inline
                          -# "Don't forget to respect this project if you liked it!"
                          %li= render 'projects/share'
                          %li= render partial: 'respects/button', locals: { project: @project }