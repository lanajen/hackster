#sidebar-container.project-pages-sidebar
  %section#sidebar-container-in
    #project-information
      .team-widget.meta
        .meta-title
          Team
          - if can? :debug, @project and can? :edit, @project
            = link_to content_tag(:i, '', class: 'fa fa-pencil'), project_edit_team_path(@project), class: 'btn-edit no-float', rel: 'tooltip', title: 'Manage team', data: { container: 'body' }
        - if @project.guest_name.present?
          .user
            = @project.guest_name
        - else
          - users = @project.team.active_members.includes(:user)
          - if users.size < 5
            - users.each do |member|
              = render partial: 'users/line_thumb', locals: { member: member }
          - else
            - users[0..3].each do |member|
              = render partial: 'users/line_thumb', locals: { member: member }
            .user= content_tag(:a, "And more #{content_tag(:i, '', class: 'fa fa-question-circle')}".html_safe, class: 'hidden-link help', data: { container: 'body', toggle: 'popover', placement: 'bottom', content: users.map { |m| render partial: 'users/line_thumb', locals: { member: m } }.join(''), html: 'true', trigger: 'hover', delay: '100' }, rel: 'popover')

      - if @project.tech_tags.any?
        .tags.meta
          .meta-title Technologies
          - @project.tech_tags.pluck(:name).each do |tag|
            - if tech = Tech.includes(:tech_tags).where("LOWER(tags.name) = ?", tag.downcase).first
              - tag_link = tech_short_path(tech)
            - else
              - tag_link = "/tags/#{CGI::escape(tag)}"
            %span= link_to tag, tag_link, class: 'tag-link'
      - elsif can? :edit, @project
        .tags.meta
          .meta-title Technologies
          No technologies yet.
          = link_to 'Add some?', edit_project_path(@project), data: { remote: true }

      - if @project.product_tags.any?
        .tags.meta
          .meta-title Tags
          - @project.product_tags.pluck(:name).each do |tag|
            %span= link_to tag, "/tags/#{CGI::escape(tag)}", class: 'tag-link'
      - elsif can? :edit, @project
        .tags.meta
          .meta-title Tags
          No tags yet.
          = link_to 'Add some?', edit_project_path(@project), data: { remote: true }

      .meta
        %strong Created on
        = l @project.created_at, format: :date
        -# if @project.created_at.to_date != @project.made_public_at.to_date
          %br
          %strong Published on
          = l @project.made_public_at, format: :date

      - if @project.guest_name.present?
        .meta
          %strong Posted by
          - poster = @project.team.active_members.includes(:user).first.user
          = link_to poster.name, poster

      - if @project.license
        .license.meta
          &copy;
          = link_to @project.license.abbr, @project.license.url, target: '_blank', class: 'hidden-link'
    #scrolling-project-section.affixable
      #scroll-nav
        = link_to 'Project Details', "javascript:smoothScrollTo('#heading', -20)", class: "scroll-nav-item active"
        = link_to 'Overview', "javascript:smoothScrollTo('#heading', -20)", class: "scroll-nav-item"
        = link_to 'Parts Needed', "javascript:smoothScrollTo('#heading', -20)", class: "scroll-nav-item"
        = link_to 'Parts Needed', "javascript:smoothScrollTo('#heading', -20)", class: "scroll-nav-item"
        = link_to 'Parts Needed', "javascript:smoothScrollTo('#heading', -20)", class: "scroll-nav-item"
        = link_to 'Parts Needed', "javascript:smoothScrollTo('#heading', -20)", class: "scroll-nav-item"
        = link_to "#{content_tag(:span, @project.comments_count, class: 'comment-count')} Comments".html_safe, "javascript:smoothScrollTo('#widget-comments', -20)", class: "scroll-nav-item"
      #project-actions.clearfix
        - if @project.public?
          = render 'projects/share'
          = render 'projects/project_embed_popup'
          = render partial: 'respects/button', locals: { project: @project }
          = render partial: 'followers/button', locals: { followable: @project }